{# templates/_task_date_form.html #}
<form
  hx-post="{{ url_for('update_due_date', task_id=t.id) }}"
  hx-target="closest td"
  hx-swap="innerHTML"
  class="flex items-center gap-2"
>
  {# Native calendar (browsers usually allow typing here too, in YYYY-MM-DD) #}
  <input
    id="due_date_input"
    name="due_date"
    type="date"
    value="{{ t.due_date.strftime('%Y-%m-%d') if t.due_date }}"
    class="border border-gray-300 rounded px-2 py-1"
  >

  <button type="submit" class="btn btn-primary">Save</button>

  <button
    type="button"
    class="btn"
    hx-post="{{ url_for('update_due_date', task_id=t.id) }}"
    hx-vals='{"clear":"1"}'
    hx-target="closest td"
    hx-swap="innerHTML"
  >
    Clear
  </button>

  <button
    type="button"
    class="btn"
    hx-get="{{ url_for('date_display', task_id=t.id) }}"
    hx-target="closest td"
    hx-swap="innerHTML"
  >
    Cancel
  </button>

  {% if error %}
    <div class="text-red-600 text-sm ml-2">{{ error }}</div>
  {% endif %}
</form>

<script>
  // Autofocus the date input when the form appears
  (function(){
    const el = document.getElementById('due_date_input');
    if (el) el.focus();
  })();
</script>
